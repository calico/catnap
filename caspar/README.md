# CASPAR

This sub-module contains code for training the CASPAR model and code for running model training specifically on the
dataset generated by the `data_processing` module.

Please see the paper for details on the CASPAR model.

One mathematical detail omitted from the paper due to space constraints is the derivation of the 
hierarchical prior on the per-mouse aging rates. A short derivation is included below for
convenience of the reader.

## Hierarchical log-beta prior derivation

Integrating out per-mouse aging rate \beta^{i}\_{star}, we get the
likelihood for the per-run aging rates \beta^{i}\_{j} in terms of the 
priors \beta_0, \tau, \sigma.

From: https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf

![](https://user-images.githubusercontent.com/2329435/157930906-5e900436-6263-4a45-a658-aac48f0bf972.png)

Taking log probabilities and summing across mice:

![](https://user-images.githubusercontent.com/2329435/157930947-9304a6c9-8d4e-434a-b541-2b461255544f.png)

where

![](https://user-images.githubusercontent.com/2329435/157931003-467ea4fa-2ff0-44c9-b31a-32611968ad07.png)
